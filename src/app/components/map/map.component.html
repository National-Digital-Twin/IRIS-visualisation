@let hasSpatialFilter = spatialFilterEnabled();
@let theme = theme$ | async;

@if (theme) {
    <div class="map-controls top">
        <div class="control-group">
            <button mat-mini-fab class="control" (click)="resetMapView.emit(null)" matTooltip="Reset view">
                <mat-icon class="icon">home</mat-icon>
            </button>
        </div>
        <div class="control-group">
            <button mat-mini-fab class="control" (click)="resetNorth.emit(null)" matTooltip="Reset to north">
                <mat-icon class="icon" [style]="'transform: rotate(' + bearing + 'deg)'">explore</mat-icon>
            </button>
            <button mat-mini-fab class="control text" (click)="changeDimensions()" [matTooltip]="twoDimensions ? 'Tilt the view to 3D' : 'Tilt the view to 2D'">
                @if (!twoDimensions) {
                    2D
                } @else {
                    3D
                }
            </button>
        </div>
        <div class="control-group">
            <button class="control" mat-mini-fab (click)="zoomIn.emit(null)" matTooltip="Zoom in">
                <mat-icon class="icon">add</mat-icon>
            </button>
            <button class="control" mat-mini-fab (click)="zoomOut.emit(null)" matTooltip="Zoom out">
                <mat-icon class="icon">remove</mat-icon>
            </button>
        </div>
        <div class="control-group">
            <button class="control" mat-mini-fab matTooltip="Draw filter area" [ngClass]="{ active: this.drawActive }" (click)="setDrawMode('polygon')">
                <mat-icon class="icon">polyline</mat-icon>
            </button>
            @if (hasSpatialFilter && mapInstance.getZoom() < 15) {
                <button class="control" mat-mini-fab matTooltip="Download addresses" (click)="downloadAddresses.emit(null)">
                    <mat-icon class="icon">download</mat-icon>
                </button>
            }
            <button class="control" mat-mini-fab matTooltip="Delete filter area" (click)="setDrawMode('delete')" [disabled]="!hasSpatialFilter">
                <mat-icon class="icon">delete</mat-icon>
            </button>
        </div>
        <div class="control-group">
            <button mat-mini-fab class="control" (click)="showLegend = !showLegend" matTooltip="Legend">
                <mat-icon class="icon">legend_toggle</mat-icon>
            </button>
            @if (showLegend) {
                <c477-legend />
            }
        </div>
    </div>
    <div class="map-controls bottom">
        <div class="control-group">
            <button mat-mini-fab class="control" (click)="toggleMinimap.emit(null)" matTooltip="Minimap">
                <mat-icon class="icon">map</mat-icon>
            </button>
        </div>
    </div>
}
<div id="map" class="map"></div>
