<mat-expansion-panel class="mat-elevation-z" [hideToggle]="false" (expandedChange)="cardSelected.emit(parentDataset)">
    <mat-expansion-panel-header collapsedHeight="auto" expandedHeight="auto" [ngClass]="{ 'results-card--select': parentDataset.ParentTOID === buildingTOID }">
        <c477-results-card
            [card]="parentDataset"
            [select]="select"
            [parent]="true"
            [checked]="cardIsChecked(dwellings)"
            (toggleChecked)="onToggleCheckedDwellings($event)"
            (cardSelected)="cardSelected.emit($event)"
        />
    </mat-expansion-panel-header>

    <ng-template matExpansionPanelContent>
        @for (dwelling of sortedDwellings(); track dwelling.UPRN) {
            <c477-results-card
                [card]="dwelling"
                [select]="select"
                [checked]="cardIsChecked([dwelling])"
                (emitViewDetails)="emitViewDetails.emit($event)"
                (toggleChecked)="toggleChecked.emit(dwelling)"
                (flag)="flag.emit([dwelling])"
                (removeFlag)="removeFlag.emit(dwelling)"
                (downloadData)="downloadData.emit($event)"
            />
        }
    </ng-template>
</mat-expansion-panel>
