@if (buildingSelection()) {
  <div class="panel results-panel">
    <section>
      <div class="results-panel__header">
        <p class="results-panel__number">
          {{ buildingSelection()?.flat()?.length }} results in view
        </p>
        <mat-slide-toggle [color]="'primary'" [(ngModel)]="selectMultiple"
          >Select multiple</mat-slide-toggle
        >
      </div>
      <div class="results-panel__header">
        <button mat-flat-button disabled class="results-panel__button">
          <img src="assets/icons/FlagPennant.svg" alt="" /> Flag selected
        </button>
        <button
          mat-flat-button
          [color]="'primary'"
          class="results-panel__button">
          <img src="assets/icons/FileArrowDown_white.svg" alt="" />Download all
        </button>
      </div>
    </section>
    <section class="results-panel__cards-container">
      <cdk-virtual-scroll-viewport
        minBufferPx="500"
        maxBufferPx="1000"
        class="viewport"
        itemSize="143">
        <div
          *cdkVirtualFor="
            let dwellingSet of buildingSelection();
            templateCacheSize: 0
          ">
          @if (dwellingSet.length === 1) {
            <c477-results-card
              [buildingUPRN]="selectedCardUPRN()"
              (cardSelected)="cardSelected($event)"
              (emitViewDetails)="viewDetails($event)"
              [card]="dwellingSet[0]"
              [select]="selectMultiple"></c477-results-card>
          } @else {
            <c477-results-card-expandable
              [dwellings]="dwellingSet"
              [select]="selectMultiple"></c477-results-card-expandable>
          }
        </div>
      </cdk-virtual-scroll-viewport>
    </section>
  </div>
}
